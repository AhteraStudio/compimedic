<!-- Header menu -->
<header class="bg-white fixed w-full z-50" style="box-shadow: 0 4px 10px rgba(51, 150, 187, 0.1);">
    <div class="container mx-auto flex items-center justify-between p-2">
        <!-- Logo (Desktop only) -->
        <div class="hidden md:flex items-center">
            <img src="https://raw.githubusercontent.com/EdilAhtera/compimedic/main/img/1721568418869.png" alt="Logo" class="h-[80px] mr-20">
        </div>

        <!-- Search Bar -->
        <div class="relative flex-1">
            <input type="text" id="searchInput" placeholder="Search..." class="w-full p-2 pr-10 border border-[#3396bb] rounded-lg" oninput="searchItems()">
            <!-- Search Icon -->
            <div class="absolute inset-y-0 right-0 flex items-center pr-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#3396bb" class="bi bi-search" viewBox="0 0 16 16">
                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
                </svg>
            </div>
        </div>

        <!-- Share Button -->
        <button class="ml-4">
            <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" viewBox="0 0 24 24">
                <path stroke="#3396BB" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.248 19C3.22 15.77 5.275 8.232 12.466 8.232V6.079a1.025 1.025 0 0 1 1.644-.862l5.479 4.307a1.108 1.108 0 0 1 0 1.723l-5.48 4.307a1.026 1.026 0 0 1-1.643-.861v-2.154C5.275 13.616 4.248 19 4.248 19Z"/>
            </svg>
        </button>

       <!-- Cart Icon -->
<button id="cart" class="ml-4 relative" onclick="openCart()">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#3396bb" class="bi bi-bag" viewBox="0 0 16 16">
        <path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1m3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1z"/>
    </svg>
    <span id="cart-badge" class="hidden absolute top-0 right-0 w-3 h-3 bg-red-600 rounded-full"></span>
</button>

<!-- template modal & card item -->
<style>
    @layer utilities {
      .line-clamp-2 {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        overflow: hidden;
        -webkit-line-clamp: 2;
      }
    }
</style>

<!-- Modal yang akan muncul ketika cart di klik -->
<div id="cart-modal" class="hidden fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center">
  <div class="bg-white w-full md:w-3/4 lg:w-2/3 h-full md:h-auto p-4 md:p-6 rounded-lg shadow-lg flex flex-col">
    <!-- Header -->
    <div class="flex items-center justify-between mb-4">
      <button class="text-gray-600 hover:text-gray-800 md:hidden" onclick="closeModal()">
        &#x2190; <!-- Simbol Back -->
      </button>
      <h2 class="text-lg md:text-xl font-semibold">Your Cart</h2>
      <button class="text-gray-600 hover:text-gray-800 hidden md:block" onclick="closeModal()">
        &#x2715; <!-- Simbol X untuk close -->
      </button>
    </div>
    
    <!-- Modal Content -->
    <div class="mt-2 flex-grow overflow-y-auto space-y-4 md:space-y-6" id="cart-items">
      <!-- Dynamic card items will be inserted here -->
    </div>

    <!-- Tombol Beli Semua (Desktop di dalam modal) -->
    <button class="bg-blue-600 text-white font-semibold py-3 rounded shadow-lg hover:bg-blue-700 mt-4 hidden md:block">
      Beli Semua
    </button>

    <!-- Tombol Beli Semua (Mobile Fixed) -->
    <button class="mt-4 bg-blue-600 text-white font-semibold py-3 text-xs md:text-lg hover:bg-blue-700 md:hidden fixed bottom-0 left-0 w-full">
      Beli Semua
    </button>
  </div>
</div>


<script>
  // Fungsi untuk membuka modal cart
  function openCart() {
    document.getElementById('cart-modal').classList.remove('hidden');
    loadCart();
  }

  // Fungsi untuk menutup modal cart
  function closeModal() {
    document.getElementById('cart-modal').classList.add('hidden');
  }

  // Fungsi untuk menambahkan item ke localStorage dan menampilkan di cart
  function addToCart(productName, productPrice) {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    
    const existingItem = cart.find(item => item.name === productName);
    
    if (existingItem) {
      existingItem.quantity += 1;
    } else {
      cart.push({ name: productName, price: productPrice, quantity: 1 });
    }
    
    localStorage.setItem('cart', JSON.stringify(cart));
    updateBadge();
  }

  // Fungsi untuk load cart dari localStorage dan tampilkan di modal
  function loadCart() {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    const cartItemsContainer = document.getElementById('cart-items');
    cartItemsContainer.innerHTML = ''; // Clear previous items

    cart.forEach((item, index) => {
      const itemCard = `
        <div class="flex justify-between items-center p-4 border rounded-md shadow-sm">
          <div>
            <h3 class="font-semibold">${item.name}</h3>
            <p>Rp. ${item.price.toLocaleString('id-ID')}</p>
          </div>
          <div class="flex items-center">
            <button onclick="decreaseQuantity(${index})" class="text-sm text-gray-500 px-2">-</button>
            <p>${item.quantity}</p>
            <button onclick="increaseQuantity(${index})" class="text-sm text-gray-500 px-2">+</button>
          </div>
          <button onclick="removeFromCart(${index})" class="text-red-500">Delete</button>
        </div>
      `;
      cartItemsContainer.insertAdjacentHTML('beforeend', itemCard);
    });
  }

  // Fungsi untuk update badge item count
  function updateBadge() {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    const badge = document.getElementById('cart-badge');
    if (cart.length > 0) {
      badge.classList.remove('hidden');
      badge.innerText = cart.length;
    } else {
      badge.classList.add('hidden');
    }
  }

  // Fungsi untuk menambah jumlah item
  function increaseQuantity(index) {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    cart[index].quantity += 1;
    localStorage.setItem('cart', JSON.stringify(cart));
    loadCart();
  }

  // Fungsi untuk mengurangi jumlah item
  function decreaseQuantity(index) {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    if (cart[index].quantity > 1) {
      cart[index].quantity -= 1;
    } else {
      cart.splice(index, 1); // Hapus item kalau quantity udah 1
    }
    localStorage.setItem('cart', JSON.stringify(cart));
    loadCart();
    updateBadge();
  }

  // Fungsi untuk menghapus item dari cart
  function removeFromCart(index) {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    cart.splice(index, 1); // Remove item
    localStorage.setItem('cart', JSON.stringify(cart));
    loadCart();
    updateBadge();
  }

  // Load cart count saat halaman pertama kali di load
  document.addEventListener('DOMContentLoaded', updateBadge);
</script>
